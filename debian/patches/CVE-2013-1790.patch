From b1026b5978c385328f2a15a2185c599a563edf91 Mon Sep 17 00:00:00 2001
From: Albert Astals Cid <aacid@kde.org>
Date: Wed, 9 Jan 2013 22:17:09 +0100
Subject: [PATCH] Initialize refLine totally

Fixes uninitialized memory read in 1004.pdf.asan.7.3
---
 poppler/Stream.cc |    7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

--- a/poppler/Stream.cc
+++ b/poppler/Stream.cc
@@ -1595,8 +1595,9 @@ int CCITTFaxStream::lookChar() {
       for (i = 0; codingLine[i] < columns; ++i) {
 	refLine[i] = codingLine[i];
       }
-      refLine[i++] = columns;
-      refLine[i] = columns;
+      for (; i < columns + 2; ++i) {
+	refLine[i] = columns;
+      }
       codingLine[0] = 0;
       a0i = 0;
       b1i = 0;
