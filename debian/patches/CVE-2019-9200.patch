From: Markus Koschany <apo@debian.org>
Date: Thu, 7 Mar 2019 16:49:07 +0100
Subject: CVE-2019-9200

Bug-Upstream: https://gitlab.freedesktop.org/poppler/poppler/issues/728
Bug-Debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=923414
Origin: https://gitlab.freedesktop.org/poppler/poppler/commit/f4136a6353162db249f63ddb0f20611622ab61b4
---
 poppler/Stream.cc | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/poppler/Stream.cc b/poppler/Stream.cc
index 556b392..8b36995 100644
--- a/poppler/Stream.cc
+++ b/poppler/Stream.cc
@@ -514,6 +514,9 @@ Guchar *ImageStream::getLine() {
   }
  
   int readChars = str->doGetChars(inputLineSize, inputLine);
+  if (unlikely(readChars == -1)) {
+      readChars = 0;
+  }
   for ( ; readChars < inputLineSize; readChars++) inputLine[readChars] = EOF;
   if (nBits == 1) {
     p = inputLine;
