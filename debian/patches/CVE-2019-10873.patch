From: Markus Koschany <apo@debian.org>
Date: Wed, 28 Sep 2022 20:52:30 +0200
Subject: CVE-2019-10873

Bug-Debian: https://bugs.debian.org/926532
Origin: https://gitlab.freedesktop.org/poppler/poppler/commit/8dbe2e6c480405dab9347075cf4be626f90f1d05
---
 splash/SplashXPathScanner.cc | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/splash/SplashXPathScanner.cc b/splash/SplashXPathScanner.cc
index ac47881..3a2a140 100644
--- a/splash/SplashXPathScanner.cc
+++ b/splash/SplashXPathScanner.cc
@@ -473,6 +473,9 @@ void SplashXPathScanner::clipAALine(SplashBitmap *aaBuf,
 	interIdx = interEnd = inter[yMax - yMin + 1];
       } else {
 	interIdx = inter[splashAASize * y + yy - yMin];
+    const int interIndex = splashAASize * y + yy - yMin;
+    if (unlikely(interIndex < 0))
+        break;
 	if (splashAASize * y + yy > yMax) {
 	  interEnd = inter[yMax - yMin + 1];
 	} else {
