From: Markus Koschany <apo@debian.org>
Date: Thu, 7 Mar 2019 14:02:15 +0100
Subject: CVE-2018-19058

Bug-Upstream: https://gitlab.freedesktop.org/poppler/poppler/issues/659
Bug-Debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=913177
Origin: https://gitlab.freedesktop.org/poppler/poppler/commit/6912e06d9ab19ba28991b5cab3319d61d856bd6d
---
 poppler/FileSpec.cc | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/poppler/FileSpec.cc b/poppler/FileSpec.cc
index bac1eae..3b3076b 100644
--- a/poppler/FileSpec.cc
+++ b/poppler/FileSpec.cc
@@ -96,6 +96,9 @@ GBool EmbFile::save(const char *path) {
 GBool EmbFile::save2(FILE *f) {
   int c;
 
+  if (unlikely(!m_objStr.isStream()))
+    return false;
+
   m_objStr.streamReset();
   while ((c = m_objStr.streamGetChar()) != EOF) {
     fputc(c, f);
