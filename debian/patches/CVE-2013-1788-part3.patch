From e14b6e9c13d35c9bd1e0c50906ace8e707816888 Mon Sep 17 00:00:00 2001
From: Albert Astals Cid <aacid@kde.org>
Date: Thu, 10 Jan 2013 20:52:02 +0100
Subject: [PATCH] Fix invalid memory access in 2030.pdf.asan.69.463

---
 poppler/Function.cc |    6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

Index: poppler-0.12.4/poppler/Function.cc
===================================================================
--- poppler-0.12.4.orig/poppler/Function.cc	2013-07-05 21:35:28.000000000 +0000
+++ poppler-0.12.4/poppler/Function.cc	2013-07-05 21:36:14.371573946 +0000
@@ -982,6 +982,10 @@
     error(-1, "Stack underflow in PostScript function");
     return;
   }
+  if (sp - n > psStackSize) {
+    error(-1, "Stack underflow in PostScript function");
+    return;
+  }
   if (!checkOverflow(n)) {
     return;
   }
