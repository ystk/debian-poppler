From: Markus Koschany <apo@debian.org>
Date: Sun, 25 Oct 2020 17:50:08 +0100
Subject: CVE-2019-14494

Bug-Debian: https://bugs.debian.org/933812
Origin: https://gitlab.freedesktop.org/poppler/poppler/commit/b224e2f5739fe61de9fa69955d016725b2a4b78d
---
 poppler/SplashOutputDev.cc | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/poppler/SplashOutputDev.cc b/poppler/SplashOutputDev.cc
index fd0f841..e7daf52 100644
--- a/poppler/SplashOutputDev.cc
+++ b/poppler/SplashOutputDev.cc
@@ -4216,6 +4216,10 @@ GBool SplashOutputDev::tilingPatternFill(GfxState *state, Gfx *gfxA, Catalog *ca
     surface_width = (int) ceil (fabs(kx));
     surface_height = (int) ceil (fabs(ky));
     // adjust repeat values to completely fill region
+    if (unlikely(surface_width == 0 || surface_height == 0)) {
+        state->setCTM(savedCTM[0], savedCTM[1], savedCTM[2], savedCTM[3], savedCTM[4], savedCTM[5]);
+        return false;
+    }
     repeatX = result_width / surface_width;
     repeatY = result_height / surface_height;
     if (surface_width * repeatX < result_width)
