From 0868c499a9f5f37f8df5c9fef03c37496b40fc8a Mon Sep 17 00:00:00 2001
From: Albert Astals Cid <aacid@kde.org>
Date: Tue, 22 May 2018 19:42:38 +0200
Subject: [PATCH] Parser::makeStream: Fix potential integer overflow

---
 poppler/Parser.cc | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

Index: poppler-0.26.5/poppler/Parser.cc
===================================================================
--- poppler-0.26.5.orig/poppler/Parser.cc	2019-09-26 14:07:58.433616554 +0200
+++ poppler-0.26.5/poppler/Parser.cc	2019-09-26 14:07:58.425616554 +0200
@@ -259,6 +259,9 @@
       pos = pos - 1;
       lexer->lookCharLastValueCached = Lexer::LOOK_VALUE_NOT_CACHED;
   }
+  if (unlikely(pos > LONG_LONG_MAX - length)) {
+      return NULL;
+  }
   lexer->setPos(pos + length);
 
   // refill token buffers and check for 'endstream'
