From 8b6dc55e530b2f5ede6b9dfb64aafdd1d5836492 Mon Sep 17 00:00:00 2001
From: Albert Astals Cid <aacid@kde.org>
Date: Thu, 10 Jan 2013 22:31:52 +0100
Subject: [PATCH] Fix invalid memory access in 1150.pdf.asan.8.69

---
 splash/Splash.cc |    5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

--- a/splash/Splash.cc
+++ b/splash/Splash.cc
@@ -1521,11 +1521,14 @@ SplashPath *Splash::makeDashedPath(Splas
   lineDashStartPhase -= (SplashCoord)i * lineDashTotal;
   lineDashStartOn = gTrue;
   lineDashStartIdx = 0;
-  while (lineDashStartPhase >= state->lineDash[lineDashStartIdx]) {
+  while (lineDashStartIdx < state->lineDashLength && lineDashStartPhase >= state->lineDash[lineDashStartIdx]) {
     lineDashStartOn = !lineDashStartOn;
     lineDashStartPhase -= state->lineDash[lineDashStartIdx];
     ++lineDashStartIdx;
   }
+  if (lineDashStartIdx == state->lineDashLength) {
+    return new SplashPath();
+  }
 
   dPath = new SplashPath();
 
