From: Markus Koschany <apo@debian.org>
Date: Thu, 7 Mar 2019 16:23:42 +0100
Subject: CVE-2019-7310

Bug-Upstream: https://gitlab.freedesktop.org/poppler/poppler/issues/717
Bug-Debian: https://bugs.debian.org/921215
---
 poppler/XRef.cc | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/poppler/XRef.cc b/poppler/XRef.cc
index 917e583..00636d8 100644
--- a/poppler/XRef.cc
+++ b/poppler/XRef.cc
@@ -1644,6 +1644,11 @@ DummyXRefEntry dummyXRefEntry;
 
 XRefEntry *XRef::getEntry(int i, GBool complainIfMissing)
 {
+  if (unlikely(i < 0)) {
+    error(errInternal, -1, "Request for invalid XRef entry [{0:d}]", i);
+    return &dummyXRefEntry;
+  }
+
   if (entries[i].type == xrefEntryNone) {
 
     if ((!xRefStream) && mainXRefEntriesOffset) {
