From: Markus Koschany <apo@debian.org>
Date: Wed, 28 Sep 2022 20:46:21 +0200
Subject: CVE-2018-13988

Bug-Debian: https://bugs.debian.org/904922
Origin: https://cgit.freedesktop.org/poppler/poppler/commit/?id=004e3c10df0abda214f0c293f9e269fdd979c5ee
---
 poppler/Parser.cc | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/poppler/Parser.cc b/poppler/Parser.cc
index 1d94781..78c3dd7 100644
--- a/poppler/Parser.cc
+++ b/poppler/Parser.cc
@@ -148,6 +148,11 @@ Object *Parser::getObj(Object *obj, GBool simpleOnly,
       obj->initRef(num, buf1.getInt());
       shift();
       shift();
+
+      if (unlikely(num <= 0)) {
+          goto err;
+      }
+
     } else {
       obj->initInt(num);
     }
